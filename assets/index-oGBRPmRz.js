(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();class f{constructor(){this.audioContext=null,this.analyser=null,this.microphone=null,this.dataArray=null,this.isListening=!1}async start(){if(!this.isListening)try{this.audioContext=new(window.AudioContext||window.webkitAudioContext);const t=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=256,this.microphone=this.audioContext.createMediaStreamSource(t),this.microphone.connect(this.analyser),this.dataArray=new Uint8Array(this.analyser.frequencyBinCount),this.isListening=!0,console.log("Audio Monitor started")}catch(t){throw console.error("Error accessing microphone:",t),t}}getVolume(){if(!this.isListening||!this.analyser)return 0;this.analyser.getByteFrequencyData(this.dataArray);let t=0;for(let a=0;a<this.dataArray.length;a++)t+=this.dataArray[a];return t/this.dataArray.length}stop(){this.audioContext&&(this.audioContext.close(),this.isListening=!1)}}class v{constructor(t){this.stress=0,this.maxStress=100,this.state="SLEEP",this.callbacks=t||{},this.sensitivity=1,this.transitionTime=3,this.decay=100/(3*60),this.threshold=10,this.states={SLEEP:{min:0,image:"sleep.png",class:"state-sleep",text:"Zzz..."},CALM:{min:10,image:"calm.png",class:"state-calm",text:"Meow"},ANXIOUS:{min:30,image:"anxious.png",class:"state-anxious",text:"O_O"},IRRITATED:{min:60,image:"irritated.png",class:"state-irritated",text:"Grrr!"},PANIC:{min:90,image:"panic.png",class:"state-panic",text:"AAAAH!!!"}}}update(t){if(t>this.threshold){const n=(t-this.threshold)*this.sensitivity*.05;this.stress+=n}else this.stress-=this.decay;return this.stress<0&&(this.stress=0),this.stress>this.maxStress&&(this.stress=this.maxStress),this.determineState(),{stress:this.stress,state:this.state}}determineState(){let t=this.state;this.stress>=90?t="PANIC":this.stress>=60?t="IRRITATED":this.stress>=30?t="ANXIOUS":this.stress>=10?t="CALM":t="SLEEP",t!==this.state&&(this.state=t,this.callbacks.onStateChange&&this.callbacks.onStateChange(this.states[this.state]))}setSettings(t,n){this.sensitivity=t,this.transitionTime=n,this.decay=this.maxStress/(Math.max(.1,this.transitionTime)*60)}}const E=""+new URL("sleep-1uQQSzBB.png",import.meta.url).href,L=""+new URL("calm-Dnba7Cyz.png",import.meta.url).href,A=""+new URL("anxious-B3yvkb7q.png",import.meta.url).href,I=""+new URL("irritated-Bx512jhd.png",import.meta.url).href,x=""+new URL("panic-vARJJI0G.png",import.meta.url).href;document.getElementById("app");const c=document.getElementById("cat-image"),l=document.getElementById("status-bubble"),S=document.getElementById("meter-fill"),C=document.getElementById("volume-display"),d=document.getElementById("start-btn"),B=document.getElementById("settings-btn"),w=document.getElementById("close-settings"),h=document.getElementById("settings-panel"),u=document.getElementById("sensitivity"),m=document.getElementById("decay"),b=document.getElementById("sensitivity-val"),M=document.getElementById("decay-val"),g=new f,P={SLEEP:E,CALM:L,ANXIOUS:A,IRRITATED:I,PANIC:x},r=new v({onStateChange:e=>{y(e)}});d.addEventListener("click",async()=>{try{await g.start(),d.style.display="none",p()}catch{alert("Could not access microphone.")}});B.addEventListener("click",()=>{h.classList.remove("hidden")});w.addEventListener("click",()=>{h.classList.add("hidden")});u.addEventListener("input",e=>{const t=parseFloat(e.target.value);b.textContent=t.toFixed(1),r.setSettings(t,parseFloat(m.value))});m.addEventListener("input",e=>{const t=parseFloat(e.target.value);M.textContent=t.toFixed(0),r.setSettings(parseFloat(u.value),t)});function y(e){const t=r.state;c.src=P[t],l.textContent=e.text,l.classList.add("visible"),document.body.className=e.class,e.class==="state-panic"||e.class==="state-irritated"?c.classList.add("shake"):c.classList.remove("shake")}function p(){const e=g.getVolume();r.update(e);const t=Math.min(100,Math.max(0,e/255*100*3));S.style.width=`${t}%`,C.textContent=Math.round(e),requestAnimationFrame(p)}y(r.states.SLEEP);
